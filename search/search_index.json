{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home These pages are my \"bag of tricks\". They contain notes about how to do various common (or sometimes random) software-related things. It is sourced from the Bag of Tricks repository on Github and is built and deployed with MkDocs .","title":"Home"},{"location":"#home","text":"These pages are my \"bag of tricks\". They contain notes about how to do various common (or sometimes random) software-related things. It is sourced from the Bag of Tricks repository on Github and is built and deployed with MkDocs .","title":"Home"},{"location":"csharp/","text":"C# DistinctBy Extension Method The following code shows an extension method for IEnumerable<T> makes a collection distinct by a certain value. public static IEnumerable < TSource > DistinctBy < TSource , TResult >( this IEnumerable < TSource > enumerable , Func < TSource , TResult > selector ) { if ( enumerable == null ) { throw new ArgumentNullException ( nameof ( enumerable )); } if ( selector == null ) { throw new ArgumentNullException ( nameof ( selector )); } HashSet < TResult > set = new HashSet < TResult >(); foreach ( TSource item in enumerable ) { TResult value = selector ( item ); if ( set . Add ( value )) { yield return item ; } } } LINQ Visualization Image source Uninstall Program by Name /// <summary> /// Uninstalls the specified product. /// </summary> public static void UninstallProduct ( string productName ) { ProcessStartInfo uninstallProcessStart = new ProcessStartInfo { FileName = \"msiexec\" , Arguments = $ \"/x {GetProductCode(productName)} /quiet\" }; Process uninstallProcess = Process . Start ( uninstallProcessStart ); uninstallProcess ?. WaitForExit (); } /// <summary> /// Returns the product code of the specified product, or null if it is not installed. /// </summary> public static string GetProductCode ( string productName ) { foreach ( RegistryKey registryKey in EnumerateInstalledProducts ()) { if ( registryKey . GetValue ( \"DisplayName\" )?. ToString () == productName ) { return registryKey . Name . Split ( '\\\\' )?. LastOrDefault (); } } return null ; } /// <summary> /// Enumerates the <see cref=\"RegistryKey\"/> objects for all the installed products. /// </summary> public static IEnumerable < RegistryKey > EnumerateInstalledProducts () { using ( RegistryKey key = Registry . LocalMachine . OpenSubKey ( @\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" )) { if ( key != null ) { foreach ( string subKeyName in key . GetSubKeyNames ()) { using ( RegistryKey subKey = key . OpenSubKey ( subKeyName )) { if ( subKey != null ) { yield return subKey ; } } } } } using ( RegistryKey key = Registry . LocalMachine . OpenSubKey ( @\"SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" )) { if ( key != null ) { foreach ( string subKeyName in key . GetSubKeyNames ()) { using ( RegistryKey subKey = key . OpenSubKey ( subKeyName )) { if ( subKey != null ) { yield return subKey ; } } } } } }","title":"C&#35;"},{"location":"csharp/#c","text":"","title":"C&#35;"},{"location":"csharp/#distinctby-extension-method","text":"The following code shows an extension method for IEnumerable<T> makes a collection distinct by a certain value. public static IEnumerable < TSource > DistinctBy < TSource , TResult >( this IEnumerable < TSource > enumerable , Func < TSource , TResult > selector ) { if ( enumerable == null ) { throw new ArgumentNullException ( nameof ( enumerable )); } if ( selector == null ) { throw new ArgumentNullException ( nameof ( selector )); } HashSet < TResult > set = new HashSet < TResult >(); foreach ( TSource item in enumerable ) { TResult value = selector ( item ); if ( set . Add ( value )) { yield return item ; } } }","title":"DistinctBy Extension Method"},{"location":"csharp/#linq-visualization","text":"Image source","title":"LINQ Visualization"},{"location":"csharp/#uninstall-program-by-name","text":"/// <summary> /// Uninstalls the specified product. /// </summary> public static void UninstallProduct ( string productName ) { ProcessStartInfo uninstallProcessStart = new ProcessStartInfo { FileName = \"msiexec\" , Arguments = $ \"/x {GetProductCode(productName)} /quiet\" }; Process uninstallProcess = Process . Start ( uninstallProcessStart ); uninstallProcess ?. WaitForExit (); } /// <summary> /// Returns the product code of the specified product, or null if it is not installed. /// </summary> public static string GetProductCode ( string productName ) { foreach ( RegistryKey registryKey in EnumerateInstalledProducts ()) { if ( registryKey . GetValue ( \"DisplayName\" )?. ToString () == productName ) { return registryKey . Name . Split ( '\\\\' )?. LastOrDefault (); } } return null ; } /// <summary> /// Enumerates the <see cref=\"RegistryKey\"/> objects for all the installed products. /// </summary> public static IEnumerable < RegistryKey > EnumerateInstalledProducts () { using ( RegistryKey key = Registry . LocalMachine . OpenSubKey ( @\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" )) { if ( key != null ) { foreach ( string subKeyName in key . GetSubKeyNames ()) { using ( RegistryKey subKey = key . OpenSubKey ( subKeyName )) { if ( subKey != null ) { yield return subKey ; } } } } } using ( RegistryKey key = Registry . LocalMachine . OpenSubKey ( @\"SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" )) { if ( key != null ) { foreach ( string subKeyName in key . GetSubKeyNames ()) { using ( RegistryKey subKey = key . OpenSubKey ( subKeyName )) { if ( subKey != null ) { yield return subKey ; } } } } } }","title":"Uninstall Program by Name"},{"location":"python/","text":"Python Virtual Environment Install virtualenv # Upgrade pip $ pip install --upgrade pip # Install virtualenv $ pip install --user virtualenv Create a New Virtual Environment # Create a new virtual environment $ python -m venv env # Activate the virtual environment $ source env/Scripts/activate # Deactivate the virtual environment $ deactivate Installing Packages # Install packages from requirements.txt $ pip install -r requirements.txt # Save installed packages to requirements.txt $ pip freeze > requirements.txt","title":"Python"},{"location":"python/#python","text":"","title":"Python"},{"location":"python/#virtual-environment","text":"","title":"Virtual Environment"},{"location":"python/#install-virtualenv","text":"# Upgrade pip $ pip install --upgrade pip # Install virtualenv $ pip install --user virtualenv","title":"Install virtualenv"},{"location":"python/#create-a-new-virtual-environment","text":"# Create a new virtual environment $ python -m venv env # Activate the virtual environment $ source env/Scripts/activate # Deactivate the virtual environment $ deactivate","title":"Create a New Virtual Environment"},{"location":"python/#installing-packages","text":"# Install packages from requirements.txt $ pip install -r requirements.txt # Save installed packages to requirements.txt $ pip freeze > requirements.txt","title":"Installing Packages"},{"location":"sql-server/","text":"SQL Server Check If Column Exists IF EXISTS ( SELECT 1 FROM sys . columns WHERE name = 'column' AND object_id = OBJECT_ID ( 'schema.table' )) BEGIN -- The column exists END Check If Index Exists IF EXISTS ( SELECT 1 FROM sys . indexes WHERE name = 'index_name' AND object_id = OBJECT_ID ( 'table_name' )) BEGIN -- The index exists END Check If Procedure Exists IF EXISTS ( SELECT 1 FROM sysobjects WHERE id = object_id ( N 'schema.proc' ) AND OBJECTPROPERTY ( id , N 'IsProcedure' ) = 1 ) BEGIN -- The procedure exists END Check If Table Exists IF EXISTS ( SELECT 1 FROM INFORMATION_SCHEMA . TABLES WHERE TABLE_SCHEMA = 'schema' AND TABLE_NAME = 'table' ) BEGIN -- The table exists END Create Procedure CREATE PROCEDURE [ schema ].[ procedure ] @ arg INT , @ argWithDefault VARCHAR ( 10 ) = NULL AS BEGIN -- Procedure body END DATETIME CONVERT() Styles Without century With century Input/Output Standard 0 100 mon dd yyyy hh:miAM/PM Default 1 101 mm/dd/yyyy US 2 102 yyyy.mm.dd ANSI 3 103 dd/mm/yyyy British/French 4 104 dd.mm.yyyy German 5 105 dd-mm-yyyy Italian 6 106 dd mon yyyy - 7 107 Mon dd, yyyy - 8 108 hh:mm:ss - 9 109 mon dd yyyy hh:mi:ss:mmmAM (or PM) Default + millisec 10 110 mm-dd-yyyy USA 11 111 yyyy/mm/dd Japan 12 112 yyyymmdd ISO 13 113 dd mon yyyy hh:mi:ss:mmm Europe (24 hour clock)> 14 114 hh:mi:ss:mmm 24 hour clock 20 120 yyyy-mm-dd hh:mi:ss ODBC canonical (24 hour clock) 21 121 yyyy-mm-dd hh:mi:ss.mmm ODBC canonical (24 hour clock) 126 yyyy-mm-ddThh:mi:ss.mmm ISO8601 127 yyyy-mm-ddThh:mi:ss.mmmZ ISO8601 (with time zone Z) 130 dd mon yyyy hh:mi:ss:mmmAM Hijiri 131 dd/mm/yy hh:mi:ss:mmmAM Hijiri Get All Database Triggers SELECT TAB . name as TableName , TRIG . name as TriggerName , TRIG . is_disabled AS IsDisabled FROM sys . triggers AS TRIG INNER JOIN sys . tables AS TAB ON TRIG . parent_id = TAB . object_id Insert or Update Row Using MERGE MERGE table_name AS target USING ( SELECT @ var1 , @ var2 , @ var3 ) AS source ( col1 , col2 , col3 ) ON ( target . col1 = source . col1 ) -- Conditions comparing \"target\" and \"source\" WHEN MATCHED THEN UPDATE SET target . col1 = source . col1 -- Update \"target\" from \"source\" WHEN NOT MATCHED BY TARGET THEN INSERT ( col1 , col2 , col3 ) VALUES ( source . col1 , source . col2 , source . col3 ) -- Insert new row from \"source\" SET NOCOUNT ON SET NOCOUNT ON prevents the message from showing which contains the number of affected rows. Using this in a stored procedure can significantly improve its performance.","title":"SQL Server"},{"location":"sql-server/#sql-server","text":"","title":"SQL Server"},{"location":"sql-server/#check-if-column-exists","text":"IF EXISTS ( SELECT 1 FROM sys . columns WHERE name = 'column' AND object_id = OBJECT_ID ( 'schema.table' )) BEGIN -- The column exists END","title":"Check If Column Exists"},{"location":"sql-server/#check-if-index-exists","text":"IF EXISTS ( SELECT 1 FROM sys . indexes WHERE name = 'index_name' AND object_id = OBJECT_ID ( 'table_name' )) BEGIN -- The index exists END","title":"Check If Index Exists"},{"location":"sql-server/#check-if-procedure-exists","text":"IF EXISTS ( SELECT 1 FROM sysobjects WHERE id = object_id ( N 'schema.proc' ) AND OBJECTPROPERTY ( id , N 'IsProcedure' ) = 1 ) BEGIN -- The procedure exists END","title":"Check If Procedure Exists"},{"location":"sql-server/#check-if-table-exists","text":"IF EXISTS ( SELECT 1 FROM INFORMATION_SCHEMA . TABLES WHERE TABLE_SCHEMA = 'schema' AND TABLE_NAME = 'table' ) BEGIN -- The table exists END","title":"Check If Table Exists"},{"location":"sql-server/#create-procedure","text":"CREATE PROCEDURE [ schema ].[ procedure ] @ arg INT , @ argWithDefault VARCHAR ( 10 ) = NULL AS BEGIN -- Procedure body END","title":"Create Procedure"},{"location":"sql-server/#datetime-convert-styles","text":"Without century With century Input/Output Standard 0 100 mon dd yyyy hh:miAM/PM Default 1 101 mm/dd/yyyy US 2 102 yyyy.mm.dd ANSI 3 103 dd/mm/yyyy British/French 4 104 dd.mm.yyyy German 5 105 dd-mm-yyyy Italian 6 106 dd mon yyyy - 7 107 Mon dd, yyyy - 8 108 hh:mm:ss - 9 109 mon dd yyyy hh:mi:ss:mmmAM (or PM) Default + millisec 10 110 mm-dd-yyyy USA 11 111 yyyy/mm/dd Japan 12 112 yyyymmdd ISO 13 113 dd mon yyyy hh:mi:ss:mmm Europe (24 hour clock)> 14 114 hh:mi:ss:mmm 24 hour clock 20 120 yyyy-mm-dd hh:mi:ss ODBC canonical (24 hour clock) 21 121 yyyy-mm-dd hh:mi:ss.mmm ODBC canonical (24 hour clock) 126 yyyy-mm-ddThh:mi:ss.mmm ISO8601 127 yyyy-mm-ddThh:mi:ss.mmmZ ISO8601 (with time zone Z) 130 dd mon yyyy hh:mi:ss:mmmAM Hijiri 131 dd/mm/yy hh:mi:ss:mmmAM Hijiri","title":"DATETIME CONVERT() Styles"},{"location":"sql-server/#get-all-database-triggers","text":"SELECT TAB . name as TableName , TRIG . name as TriggerName , TRIG . is_disabled AS IsDisabled FROM sys . triggers AS TRIG INNER JOIN sys . tables AS TAB ON TRIG . parent_id = TAB . object_id","title":"Get All Database Triggers"},{"location":"sql-server/#insert-or-update-row-using-merge","text":"MERGE table_name AS target USING ( SELECT @ var1 , @ var2 , @ var3 ) AS source ( col1 , col2 , col3 ) ON ( target . col1 = source . col1 ) -- Conditions comparing \"target\" and \"source\" WHEN MATCHED THEN UPDATE SET target . col1 = source . col1 -- Update \"target\" from \"source\" WHEN NOT MATCHED BY TARGET THEN INSERT ( col1 , col2 , col3 ) VALUES ( source . col1 , source . col2 , source . col3 ) -- Insert new row from \"source\"","title":"Insert or Update Row Using MERGE"},{"location":"sql-server/#set-nocount-on","text":"SET NOCOUNT ON prevents the message from showing which contains the number of affected rows. Using this in a stored procedure can significantly improve its performance.","title":"SET NOCOUNT ON"},{"location":"windows/","text":"Windows Run a Program at Startup Open the Startup folder. Press Windows + R to open Run. Type shell:startup. Add a shortcut to the program to the Startup folder.","title":"Windows"},{"location":"windows/#windows","text":"","title":"Windows"},{"location":"windows/#run-a-program-at-startup","text":"Open the Startup folder. Press Windows + R to open Run. Type shell:startup. Add a shortcut to the program to the Startup folder.","title":"Run a Program at Startup"},{"location":"wpf/","text":"WPF Filtering a Collection Without Modifying It private ObservableCollection < string > myBackingCollection = new ObservableCollection < string >(); public ICollectionView MyCollectionView { get { ICollectionView view = CollectionViewSource . GetDefaultView ( this . myBackingColleciton ); view . Filter = ( obj ) => true ; // Filter delegate return view ; } } Remove Toolbar Grip and Overflow XAML <ToolBarPanel DockPanel.Dock= \"Top\" > <ToolBar ToolBarTray.IsLocked= \"True\" Loaded= \"ToolBar_Loaded\" > <Menu ToolBar.OverflowMode= \"Never\" > <!-- Menu items --> </Menu> </ToolBar> </ToolBarPanel> Code behind private void ToolBar_Loaded ( object sender , RoutedEventArgs e ) { ToolBar toolBar = sender as ToolBar ; var overflowGrid = toolBar . Template . FindName ( \"OverflowGrid\" , toolBar ) as FrameworkElement ; if ( overflowGrid != null ) { overflowGrid . Visibility = Visibility . Collapsed ; } var mainPanelBorder = toolBar . Template . FindName ( \"MainPanelBorder\" , toolBar ) as FrameworkElement ; if ( mainPanelBorder != null ) { mainPanelBorder . Margin = new Thickness (); } } Span All Grid Rows and Columns The following code shows how to make a control span all rows and/or columns of its parent grid, even if the number of rows and columns change. <Grid> <!-- Other stuff in the grid --> <ContentControl Grid.RowSpan= \"{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count, Mode=OneWay}\" Grid.ColumnSpan= \"{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count, Mode=OneWay}\" /> </Grid>","title":"WPF"},{"location":"wpf/#wpf","text":"","title":"WPF"},{"location":"wpf/#filtering-a-collection-without-modifying-it","text":"private ObservableCollection < string > myBackingCollection = new ObservableCollection < string >(); public ICollectionView MyCollectionView { get { ICollectionView view = CollectionViewSource . GetDefaultView ( this . myBackingColleciton ); view . Filter = ( obj ) => true ; // Filter delegate return view ; } }","title":"Filtering a Collection Without Modifying It"},{"location":"wpf/#remove-toolbar-grip-and-overflow","text":"XAML <ToolBarPanel DockPanel.Dock= \"Top\" > <ToolBar ToolBarTray.IsLocked= \"True\" Loaded= \"ToolBar_Loaded\" > <Menu ToolBar.OverflowMode= \"Never\" > <!-- Menu items --> </Menu> </ToolBar> </ToolBarPanel> Code behind private void ToolBar_Loaded ( object sender , RoutedEventArgs e ) { ToolBar toolBar = sender as ToolBar ; var overflowGrid = toolBar . Template . FindName ( \"OverflowGrid\" , toolBar ) as FrameworkElement ; if ( overflowGrid != null ) { overflowGrid . Visibility = Visibility . Collapsed ; } var mainPanelBorder = toolBar . Template . FindName ( \"MainPanelBorder\" , toolBar ) as FrameworkElement ; if ( mainPanelBorder != null ) { mainPanelBorder . Margin = new Thickness (); } }","title":"Remove Toolbar Grip and Overflow"},{"location":"wpf/#span-all-grid-rows-and-columns","text":"The following code shows how to make a control span all rows and/or columns of its parent grid, even if the number of rows and columns change. <Grid> <!-- Other stuff in the grid --> <ContentControl Grid.RowSpan= \"{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count, Mode=OneWay}\" Grid.ColumnSpan= \"{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count, Mode=OneWay}\" /> </Grid>","title":"Span All Grid Rows and Columns"}]}